const _0x198a05=_0x21e4;function _0x29a7(){const _0x3526c3=['express-session','params','/menu','/admin','No\x20se\x20pudo\x20leer\x20la\x20portada\x20actual,\x20usando\x20valor\x20por\x20defecto:','Error\x20al\x20buscar\x20usuario:','/login?redirect=','verbose','Error\x20al\x20obtener\x20los\x20platillos:','readFileSync','Servidor\x20escuchando\x20en\x20http://localhost:','Error\x20al\x20leer\x20el\x20directorio\x20de\x20imágenes:','cover','get','/login','login','222ScVLtL','Error\x20en\x20la\x20ruta\x20/login:','run','compare','SELECT\x20*\x20FROM\x20users\x20WHERE\x20username\x20=\x20?','8pSFBly','all','admin','Error\x20interno\x20del\x20servidor','151205vevllq','status','addPlatillo','tu_clave_secreta','/delete/:id','originalUrl','error','Promesa\x20rechazada\x20sin\x20manejar:','6682410CsknLl','password','9908BqRTob','listen','./serverDate','Intento\x20de\x20inicio\x20de\x20sesión\x20fallido:\x20contraseña\x20incorrecta','render','send','path','SELECT\x20*\x20FROM\x20platillos\x20WHERE\x20id\x20=\x20?','post','username','warn','ejs','253616mjzZsI','body','menu','edit','unhandledRejection','utf8','Usuario\x20o\x20contraseña\x20incorrectos','trim','Intento\x20de\x20inicio\x20de\x20sesión\x20fallido:\x20usuario\x20no\x20encontrado','public','SELECT\x20*\x20FROM\x20platillos\x20WHERE\x20disponibilidad\x20=\x201\x20ORDER\x20BY\x20categoria,\x20nombre','Error\x20al\x20eliminar\x20el\x20platillo:','Error\x20al\x20actualizar\x20el\x20platillo','Error\x20al\x20obtener\x20los\x20platillos','use','./currentCover.txt','/coverEdit','stringify','set','body-parser','log','DELETE\x20FROM\x20platillos\x20WHERE\x20id\x20=\x20?','./platillos.db','Database','4719879trmEkH','/edit/:id','Acceso\x20denegado.\x20Ruta:\x20','urlencoded','4422187zRzHmR','Error\x20al\x20agregar\x20el\x20platillo','join','Error\x20al\x20agregar\x20el\x20platillo:','/add','Error\x20al\x20conectar\x20a\x20la\x20base\x20de\x20datos','redirect',',\x20Sesión:\x20','uncaughtException','userId','sqlite3','views','Error\x20al\x20obtener\x20el\x20platillo','SELECT\x20*\x20FROM\x20platillos','reduce','Error\x20al\x20actualizar\x20el\x20platillo:','732270IoeXIQ','/logout','message','writeFileSync','Error\x20al\x20cargar\x20las\x20imágenes','102mCtvSe','UPDATE\x20platillos\x20SET\x20categoria=?,\x20nombre=?,\x20descripcion=?,\x20precio=?,\x20disponibilidad=?\x20WHERE\x20id=?','readdir','categoria','destroy','session','Acceso\x20permitido\x20para\x20el\x20usuario:\x20','query','Platillo\x20no\x20encontrado','Error\x20al\x20eliminar\x20el\x20platillo','express','bcrypt'];_0x29a7=function(){return _0x3526c3;};return _0x29a7();}function _0x21e4(_0x351bd5,_0x3408da){const _0x29a714=_0x29a7();return _0x21e4=function(_0x21e4e0,_0x505696){_0x21e4e0=_0x21e4e0-0x1cc;let _0x29e8e4=_0x29a714[_0x21e4e0];return _0x29e8e4;},_0x21e4(_0x351bd5,_0x3408da);}(function(_0x1b0334,_0x43c7e4){const _0x5c01f8=_0x21e4,_0x469f20=_0x1b0334();while(!![]){try{const _0x1a26e7=parseInt(_0x5c01f8(0x206))/0x1+-parseInt(_0x5c01f8(0x232))/0x2+parseInt(_0x5c01f8(0x1e7))/0x3*(parseInt(_0x5c01f8(0x1fa))/0x4)+-parseInt(_0x5c01f8(0x1f0))/0x5*(parseInt(_0x5c01f8(0x237))/0x6)+parseInt(_0x5c01f8(0x222))/0x7*(parseInt(_0x5c01f8(0x1ec))/0x8)+-parseInt(_0x5c01f8(0x21e))/0x9+parseInt(_0x5c01f8(0x1f8))/0xa;if(_0x1a26e7===_0x43c7e4)break;else _0x469f20['push'](_0x469f20['shift']());}catch(_0x432a0e){_0x469f20['push'](_0x469f20['shift']());}}}(_0x29a7,0x511c9));const express=require(_0x198a05(0x1d5)),sqlite3=require(_0x198a05(0x22c))[_0x198a05(0x1de)](),path=require(_0x198a05(0x200)),fs=require('fs'),bcrypt=require(_0x198a05(0x1d6)),session=require(_0x198a05(0x1d7)),bodyParser=require(_0x198a05(0x219)),app=express(),port=0xbb8,db=new sqlite3[(_0x198a05(0x21d))](_0x198a05(0x21c),_0x121504=>{const _0x3c9de3=_0x198a05;_0x121504?console[_0x3c9de3(0x1f6)](_0x3c9de3(0x227),_0x121504[_0x3c9de3(0x234)]):console[_0x3c9de3(0x21a)]('Conectado\x20a\x20la\x20base\x20de\x20datos\x20SQLite');});app['use'](session({'secret':_0x198a05(0x1f3),'resave':![],'saveUninitialized':![]})),app[_0x198a05(0x214)](bodyParser[_0x198a05(0x221)]({'extended':![]})),app[_0x198a05(0x218)]('view\x20engine',_0x198a05(0x205)),app[_0x198a05(0x218)]('views',path[_0x198a05(0x224)](__dirname,_0x198a05(0x22d))),app[_0x198a05(0x214)](express['static'](path[_0x198a05(0x224)](__dirname,_0x198a05(0x20f))));function requireAuth(_0x461dac,_0x4a621f,_0x3ae6bc){const _0x5c7482=_0x198a05;if(!_0x461dac[_0x5c7482(0x1d0)]['userId'])return console['warn'](_0x5c7482(0x220)+_0x461dac[_0x5c7482(0x1f5)]+_0x5c7482(0x229)+JSON[_0x5c7482(0x217)](_0x461dac['session'])),_0x4a621f['redirect'](_0x5c7482(0x1dd)+encodeURIComponent(_0x461dac[_0x5c7482(0x1f5)]));console[_0x5c7482(0x21a)](_0x5c7482(0x1d1)+_0x461dac['session'][_0x5c7482(0x22b)]),_0x3ae6bc();}process['on'](_0x198a05(0x22a),_0x65f725=>{const _0x44d934=_0x198a05;console[_0x44d934(0x1f6)]('Error\x20no\x20capturado:',_0x65f725['message']);}),process['on'](_0x198a05(0x20a),_0x2ddb62=>{const _0x1972b7=_0x198a05;console['error'](_0x1972b7(0x1f7),_0x2ddb62);}),app['get'](_0x198a05(0x1e5),(_0x272322,_0x28bed4)=>{const _0x2fa49f=_0x198a05;try{const _0x3ad7c3=_0x272322[_0x2fa49f(0x1d2)][_0x2fa49f(0x228)]||'/';_0x28bed4[_0x2fa49f(0x1fe)](_0x2fa49f(0x1e6),{'error':null,'redirectUrl':_0x3ad7c3});}catch(_0x2ced07){console[_0x2fa49f(0x1f6)](_0x2fa49f(0x1e8),_0x2ced07[_0x2fa49f(0x234)]),_0x28bed4['status'](0x1f4)[_0x2fa49f(0x1ff)]('Error\x20en\x20la\x20página\x20de\x20inicio\x20de\x20sesión');}}),app[_0x198a05(0x202)](_0x198a05(0x1e5),(_0x51a275,_0x3475bb)=>{const _0x1b58f8=_0x198a05,{username:_0x1561d5,password:_0x2e168e}=_0x51a275['body'],_0x1c139b=_0x51a275[_0x1b58f8(0x207)][_0x1b58f8(0x228)]||_0x1b58f8(0x1da);db[_0x1b58f8(0x1e4)](_0x1b58f8(0x1eb),[_0x1561d5],async(_0x14e8e0,_0x31a55b)=>{const _0x4d9da=_0x1b58f8;if(_0x14e8e0)return console['error'](_0x4d9da(0x1dc),_0x14e8e0[_0x4d9da(0x234)]),_0x3475bb[_0x4d9da(0x1fe)](_0x4d9da(0x1e6),{'error':_0x4d9da(0x1ef),'redirectUrl':_0x1c139b});if(!_0x31a55b)return console[_0x4d9da(0x204)](_0x4d9da(0x20e)),_0x3475bb['render'](_0x4d9da(0x1e6),{'error':_0x4d9da(0x20c),'redirectUrl':_0x1c139b});const _0x3d63f3=await bcrypt[_0x4d9da(0x1ea)](_0x2e168e,_0x31a55b[_0x4d9da(0x1f9)]);if(!_0x3d63f3)return console[_0x4d9da(0x204)](_0x4d9da(0x1fd)),_0x3475bb['render']('login',{'error':_0x4d9da(0x20c),'redirectUrl':_0x1c139b});console['log']('Inicio\x20de\x20sesión\x20exitoso:',_0x31a55b[_0x4d9da(0x203)]),_0x51a275[_0x4d9da(0x1d0)][_0x4d9da(0x22b)]=_0x31a55b['id'],_0x51a275[_0x4d9da(0x1d0)][_0x4d9da(0x203)]=_0x31a55b[_0x4d9da(0x203)],_0x3475bb['redirect'](_0x1c139b);});}),app[_0x198a05(0x1e4)](_0x198a05(0x233),(_0x3ed6cb,_0x31f3b0)=>{const _0x3ab12b=_0x198a05;_0x3ed6cb[_0x3ab12b(0x1d0)][_0x3ab12b(0x1cf)](()=>{const _0x885f17=_0x3ab12b;_0x31f3b0[_0x885f17(0x228)](_0x885f17(0x1e5));});}),app['get']('/',(_0x4c5069,_0x39d682)=>{const _0x3c1877=_0x198a05;require(_0x3c1877(0x1fc));let _0x1f848;try{_0x1f848=fs[_0x3c1877(0x1e0)](_0x3c1877(0x215),_0x3c1877(0x20b))[_0x3c1877(0x20d)]();}catch(_0x5d9054){console[_0x3c1877(0x1f6)](_0x3c1877(0x1db),_0x5d9054),_0x1f848='desayuno.png';}_0x39d682['render'](_0x3c1877(0x1e3),{'currentCover':_0x1f848,'username':_0x4c5069[_0x3c1877(0x1d0)][_0x3c1877(0x203)]});}),app[_0x198a05(0x1e4)](_0x198a05(0x1d9),(_0x118fe6,_0xcb10c3)=>{const _0x456f22=_0x198a05;db[_0x456f22(0x1ed)](_0x456f22(0x210),[],(_0x4aeba4,_0xffb75e)=>{const _0x587e30=_0x456f22;if(_0x4aeba4)return console[_0x587e30(0x1f6)](_0x587e30(0x1df),_0x4aeba4[_0x587e30(0x234)]),_0xcb10c3[_0x587e30(0x1f1)](0x1f4)[_0x587e30(0x1ff)]('Error\x20al\x20obtener\x20los\x20platillos');const _0x235332=_0xffb75e[_0x587e30(0x230)]((_0x20a613,_0x3c9691)=>{const _0x5d3906=_0x587e30;return!_0x20a613[_0x3c9691[_0x5d3906(0x1ce)]]&&(_0x20a613[_0x3c9691['categoria']]=[]),_0x20a613[_0x3c9691[_0x5d3906(0x1ce)]]['push'](_0x3c9691),_0x20a613;},{});_0xcb10c3[_0x587e30(0x1fe)](_0x587e30(0x208),{'platillosPorCategoria':_0x235332});});}),app[_0x198a05(0x1e4)](_0x198a05(0x1da),requireAuth,(_0x1f4d53,_0xbaa361)=>{const _0x450682=_0x198a05;db[_0x450682(0x1ed)](_0x450682(0x22f),[],(_0xd45665,_0x2209d1)=>{const _0x2a7bc3=_0x450682;if(_0xd45665)return console[_0x2a7bc3(0x1f6)](_0x2a7bc3(0x1df),_0xd45665[_0x2a7bc3(0x234)]),_0xbaa361[_0x2a7bc3(0x1f1)](0x1f4)[_0x2a7bc3(0x1ff)](_0x2a7bc3(0x213));_0xbaa361[_0x2a7bc3(0x1fe)](_0x2a7bc3(0x1ee),{'platillos':_0x2209d1});});}),app['get'](_0x198a05(0x226),requireAuth,(_0x3cabea,_0x1db2af)=>{const _0x531197=_0x198a05;_0x1db2af[_0x531197(0x1fe)](_0x531197(0x1f2));}),app[_0x198a05(0x202)](_0x198a05(0x226),requireAuth,(_0x4aac47,_0x260b5b)=>{const _0x513450=_0x198a05,{categoria:_0x44f444,nombre:_0x53a7b1,descripcion:_0x5a99ea,precio:_0xf05566,disponibilidad:_0x94f34e}=_0x4aac47[_0x513450(0x207)];if(!_0x44f444||!_0x53a7b1||!_0x5a99ea||!_0xf05566)return _0x260b5b[_0x513450(0x1f1)](0x190)[_0x513450(0x1ff)]('Todos\x20los\x20campos\x20son\x20requeridos');db[_0x513450(0x1e9)]('INSERT\x20INTO\x20platillos\x20(categoria,\x20nombre,\x20descripcion,\x20precio,\x20disponibilidad)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)',[_0x44f444,_0x53a7b1,_0x5a99ea,_0xf05566,_0x94f34e||0x1],_0x44b1f5=>{const _0x146290=_0x513450;if(_0x44b1f5)return console[_0x146290(0x1f6)](_0x146290(0x225),_0x44b1f5[_0x146290(0x234)]),_0x260b5b[_0x146290(0x1f1)](0x1f4)[_0x146290(0x1ff)](_0x146290(0x223));_0x260b5b[_0x146290(0x228)](_0x146290(0x1da));});}),app[_0x198a05(0x1e4)](_0x198a05(0x21f),requireAuth,(_0x701cbd,_0x43e970)=>{const _0x515733=_0x198a05,_0x5582cc=_0x701cbd[_0x515733(0x1d8)]['id'];db['get'](_0x515733(0x201),[_0x5582cc],(_0x2567df,_0xbb18a)=>{const _0x368937=_0x515733;if(_0x2567df)return console[_0x368937(0x1f6)]('Error\x20al\x20obtener\x20el\x20platillo:',_0x2567df[_0x368937(0x234)]),_0x43e970[_0x368937(0x1f1)](0x1f4)['send'](_0x368937(0x22e));if(!_0xbb18a)return _0x43e970[_0x368937(0x1f1)](0x194)['send'](_0x368937(0x1d3));_0x43e970['render'](_0x368937(0x209),{'platillo':_0xbb18a,'error':null});});}),app[_0x198a05(0x202)](_0x198a05(0x21f),requireAuth,(_0x1cd9fe,_0x5c9a2d)=>{const _0x5c2b01=_0x198a05,{id:_0x1ffc5d}=_0x1cd9fe['params'],{categoria:_0x48f47d,nombre:_0x252d40,descripcion:_0x45b5e4,precio:_0x32666a,disponibilidad:_0x3e4920}=_0x1cd9fe[_0x5c2b01(0x207)];db[_0x5c2b01(0x1e9)](_0x5c2b01(0x1cc),[_0x48f47d,_0x252d40,_0x45b5e4,_0x32666a,_0x3e4920,_0x1ffc5d],_0x5aacfc=>{const _0x5b7b82=_0x5c2b01;if(_0x5aacfc)return console[_0x5b7b82(0x1f6)](_0x5b7b82(0x231),_0x5aacfc[_0x5b7b82(0x234)]),_0x5c9a2d[_0x5b7b82(0x1f1)](0x1f4)[_0x5b7b82(0x1ff)](_0x5b7b82(0x212));_0x5c9a2d[_0x5b7b82(0x228)](_0x5b7b82(0x1da));});}),app[_0x198a05(0x202)](_0x198a05(0x1f4),requireAuth,(_0x2d5f4f,_0x2fe30a)=>{const _0x400f2b=_0x198a05,{id:_0x4b09e6}=_0x2d5f4f[_0x400f2b(0x1d8)];db[_0x400f2b(0x1e9)](_0x400f2b(0x21b),[_0x4b09e6],_0x4d692e=>{const _0x5b0b04=_0x400f2b;if(_0x4d692e)return console['error'](_0x5b0b04(0x211),_0x4d692e['message']),_0x2fe30a[_0x5b0b04(0x1f1)](0x1f4)[_0x5b0b04(0x1ff)](_0x5b0b04(0x1d4));_0x2fe30a[_0x5b0b04(0x228)](_0x5b0b04(0x1da));});}),app[_0x198a05(0x1e4)](_0x198a05(0x216),requireAuth,(_0x20cd2b,_0x3cb8ff)=>{const _0x1a9a25=_0x198a05,_0x2ddb25=path[_0x1a9a25(0x224)](__dirname,'public/img/coverImages');fs[_0x1a9a25(0x1cd)](_0x2ddb25,(_0x99199b,_0xa2b659)=>{const _0x32a18e=_0x1a9a25;if(_0x99199b)return console[_0x32a18e(0x1f6)](_0x32a18e(0x1e2),_0x99199b),_0x3cb8ff['status'](0x1f4)['send'](_0x32a18e(0x236));const _0x3f181e=_0xa2b659['filter'](_0x4590ed=>/\.(png|jpe?g)$/['test'](_0x4590ed));let _0x21b7b6;try{_0x21b7b6=fs['readFileSync']('./currentCover.txt',_0x32a18e(0x20b))['trim']();}catch(_0x5c6bd4){_0x21b7b6='';}_0x3cb8ff['render']('coverEdit',{'images':_0x3f181e,'currentCover':_0x21b7b6});});}),app[_0x198a05(0x202)]('/coverEdit',requireAuth,(_0x306234,_0x51136e)=>{const _0x195545=_0x198a05,{portadaSeleccionada:_0x2e5dd6}=_0x306234[_0x195545(0x207)];if(!_0x2e5dd6)return _0x51136e[_0x195545(0x1f1)](0x190)[_0x195545(0x1ff)]('No\x20se\x20seleccionó\x20ninguna\x20portada');fs[_0x195545(0x235)](_0x195545(0x215),_0x2e5dd6,_0x195545(0x20b)),_0x51136e[_0x195545(0x228)]('/coverEdit');}),app[_0x198a05(0x1fb)](port,()=>{const _0x1f7f23=_0x198a05;console[_0x1f7f23(0x21a)](_0x1f7f23(0x1e1)+port);});
